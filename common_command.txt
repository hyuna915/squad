# Train
python main.py --experiment_name=bidaf --mode=train  --bidaf=True

python main.py --experiment_name=lstm2 --mode=train  --multi_lstm=True

python main.py --experiment_name=lstm2_bidaf --mode=train  --multi_lstm=True --bidaf=True

python main.py --experiment_name=cond --mode=train --cond_pred=True

# Eval
python code/main.py --mode=official_eval --json_in_path=data/tiny-dev.json --ckpt_load_dir=experiments/baseline/best_checkpoint --json_out_path=results/baseline/predictions.json

python code/evaluate.py data/tiny-dev.json results/lstm2_0314/predictions.json

python code/main.py --mode=official_eval --json_in_path=data/tiny-dev.json --ckpt_load_dir=results/lstm2_0314/best_checkpoint --multi_lstm=True --json_out_path=results/lstm2_0314/predictions1.json --smart_span=False

python code/main.py --mode=official_eval --json_in_path=data/dev-v1.1.json --ckpt_load_dir=results/lstm2_0314/best_checkpoint --json_out_path=results/lstm2_0314/predictions-dev.json --multi_lstm=True

python code/evaluate.py data/dev-v1.1.json results/lstm2_0314/predictions-dev.json > results/lstm2_0314/F1-dev.txt

# Login Azure
ssh heguangl@13.84.191.121
ssh heguangl@13.84.130.140

scp -rp heguangl@13.84.130.140:/home/heguangl/squad/experiments/bidaf/best_checkpoint/ .
scp heguangl@13.84.130.140:/home/heguangl/squad/experiments/lstm2/log.txt .
scp heguangl@13.84.130.140:/home/heguangl/squad/experiments/baseline/flags.json .

# Tensorboard
tensorboard --logdir=. --port=5678
ssh -N -f -L localhost:2345:localhost:6789 heguangl@13.84.191.121
cat log.txt | grep "Dev F1 score"

# submit to leaderboard

cl run --name gen-answers --request-docker-image abisee/cs224n-dfp:v4 :code :best_checkpoint glove.txt:0x97c870/glove.6B.100d.txt data.json:0x4870af \
'python code/main.py --mode=official_eval --glove_path=glove.txt --json_in_path=data.json --ckpt_load_dir=best_checkpoint'

cl run --name run-eval --request-docker-image abisee/cs224n-dfp:v4 :code data.json:0x4870af preds.json:gen-answers/predictions.json 'python code/evaluate.py data.json preds.json'

cl edit gen-answers -T cs224n-win18-sanity-check --description "Baseline 28K iteration"

cl edit gen-answers -T cs224n-win18-dev --description "Baseline 28K iteration"